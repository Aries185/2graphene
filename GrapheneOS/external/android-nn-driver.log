commit 3c367f1ddaaba93c43cfe86680067ab42ebe4607 (HEAD, tag: SP2A.220305.012.2022030801, m/master, grapheneos/12.1)
Author: Danny Lin <danny@kdrag0n.dev>
Date:   Tue 2021-12-07 20:00:18-0800

    Link to libOpenCL unconditionally when building OpenCL backend
    
    We only build the OpenCL backend if libOpenCL has been extracted as a
    prebuilt library in vendor/google_devices, so relax the check and
    assume that libOpenCL is available for linking.
    
    Change-Id: I5399fc04be7b4b8f29e586b857a1d520a41ddd02
---
 Android.mk | 32 --------------------------------
 1 file changed, 32 deletions(-)

diff --git a/Android.mk b/Android.mk
index 06c653d6381fc64860dabdefbf91891d2414c85e..45ac94b76bd62a5dd06f5fb8caa294935fbdae45 100644
--- a/Android.mk
+++ b/Android.mk
@@ -172,26 +172,22 @@ LOCAL_SHARED_LIBRARIES+= \
         android.hardware.neuralnetworks@1.2
 endif # Q or later
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # R or later
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 include $(BUILD_STATIC_LIBRARY)
 
 ifeq ($(P_OR_LATER),1)
 # The following target is available starting from Android P
 
 #######################
 # libarmnn-driver@1.1 #
 #######################
 include $(CLEAR_VARS)
@@ -303,26 +299,22 @@ LOCAL_SHARED_LIBRARIES+= \
         android.hardware.neuralnetworks@1.2
 endif # PLATFORM_VERSION == Q
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # R or later
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 include $(BUILD_STATIC_LIBRARY)
 
 endif # PLATFORM_VERSION == 9
 
 ifeq ($(Q_OR_LATER),1)
 # The following target is available starting from Android Q
 
 #######################
 # libarmnn-driver@1.2 #
@@ -429,26 +421,22 @@ LOCAL_SHARED_LIBRARIES := \
         android.hardware.neuralnetworks@1.1 \
         android.hardware.neuralnetworks@1.2
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # R or later
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 include $(BUILD_STATIC_LIBRARY)
 
 endif # PLATFORM_VERSION == Q
 
 ifeq ($(R_OR_LATER),1)
 # The following target is available starting from Android R
 
 #######################
 # libarmnn-driver@1.3 #
@@ -550,26 +538,22 @@ LOCAL_SHARED_LIBRARIES := \
         libcutils \
         android.hidl.allocator@1.0 \
         android.hidl.memory@1.0 \
         libsync \
         android.hardware.neuralnetworks@1.0 \
         android.hardware.neuralnetworks@1.1 \
         android.hardware.neuralnetworks@1.2 \
         android.hardware.neuralnetworks@1.3
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 include $(BUILD_STATIC_LIBRARY)
 
 endif # PLATFORM_VERSION == R
 
 #####################################################
 # android.hardware.neuralnetworks@1.0-service-armnn #
 #####################################################
 include $(CLEAR_VARS)
 
@@ -658,26 +642,22 @@ ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= android.hardware.neuralnetworks@1.3
 endif # PLATFORM_VERSION == R
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # R or later
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 include $(BUILD_EXECUTABLE)
 
 ifeq ($(P_OR_LATER),1)
 # The following target is available starting from Android P
 
 #####################################################
 # android.hardware.neuralnetworks@1.1-service-armnn #
 #####################################################
 include $(CLEAR_VARS)
@@ -759,26 +739,22 @@ LOCAL_SHARED_LIBRARIES+= \
         android.hardware.neuralnetworks@1.2
 endif # PLATFORM_VERSION == Q
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # PLATFORM_VERSION == R
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
 endif
-endif
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= android.hardware.neuralnetworks@1.3
 endif # PLATFORM_VERSION == R
 
 include $(BUILD_EXECUTABLE)
 
 endif # PLATFORM_VERSION == 9
 
 ifeq ($(Q_OR_LATER),1)
@@ -862,25 +838,21 @@ LOCAL_SHARED_LIBRARIES := \
         android.hardware.neuralnetworks@1.2 \
         android.hardware.neuralnetworks@1.3
 
 ifeq ($(R_OR_LATER),1)
 LOCAL_SHARED_LIBRARIES+= \
         libsync \
         android.hardware.neuralnetworks@1.3
 endif # R or later
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
-endif
 
 
 LOCAL_LDFLAGS_32 := -Wl,-rpath,/vendor/lib/egl
 LOCAL_LDFLAGS_64 := -Wl,-rpath,/vendor/lib64/egl
 endif
 
 include $(BUILD_EXECUTABLE)
 
 endif # PLATFORM_VERSION == Q
 
@@ -951,25 +923,21 @@ LOCAL_SHARED_LIBRARIES := \
         libcutils \
         libsync \
         android.hidl.allocator@1.0 \
         android.hidl.memory@1.0 \
         android.hardware.neuralnetworks@1.0 \
         android.hardware.neuralnetworks@1.1 \
         android.hardware.neuralnetworks@1.2 \
         android.hardware.neuralnetworks@1.3
 
 ifeq ($(ARMNN_INCLUDE_LIBOPENCL),1)
-ifeq (,$(realpath $(TOPDIR)vendor/arm/mali/valhall/Android.bp))
-    LOCAL_SHARED_LIBRARIES += libGLES_mali
-else
     LOCAL_SHARED_LIBRARIES += libOpenCL
-endif
 LOCAL_LDFLAGS_32 := -Wl,-rpath,/vendor/lib/egl
 LOCAL_LDFLAGS_64 := -Wl,-rpath,/vendor/lib64/egl
 endif
 
 include $(BUILD_EXECUTABLE)
 
 endif # PLATFORM_VERSION == R
 
 ##########################
 # armnn module and tests #

commit ce12ad48966be019396f96109781f02e512b1e34
Author: flawedworld <flawedworld@flawed.world>
Date:   Sat 2021-08-28 17:42:40+0000

    Set sane value for PRODUCT_MODEL
---
 aosp_barbet.mk | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/aosp_barbet.mk b/aosp_barbet.mk
index cf2c90eed900c30544d903e27d3a3b9b2001018c..e65646dbeeb4d7a021c48dee15d695466d95dd60 100644
--- a/aosp_barbet.mk
+++ b/aosp_barbet.mk
@@ -51,11 +51,11 @@ PRODUCT_BUILD_SUPER_PARTITION := false
 # b/113232673 STOPSHIP deal with Qualcomm stuff later
 # PRODUCT_RESTRICT_VENDOR_FILES := all
 
 # b/189477034: Bypass build time check on uses_libs until vendor fixes all their apps
 PRODUCT_BROKEN_VERIFY_USES_LIBRARIES := true
 
 PRODUCT_MANUFACTURER := Google
 PRODUCT_BRAND := Android
 PRODUCT_NAME := aosp_barbet
 PRODUCT_DEVICE := barbet
-PRODUCT_MODEL := AOSP on barbet
+PRODUCT_MODEL := Pixel 5a

commit bb6d3d282655c221957fe4fea5230acc9e2b6221
Author: flawedworld <flawedworld@flawed.world>
Date:   Fri 2021-08-27 14:40:25+0000

    set PRODUCT_BRAND to hardware brand
---
 aosp_barbet.mk | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/aosp_barbet.mk b/aosp_barbet.mk
index e65646dbeeb4d7a021c48dee15d695466d95dd60..cdff73414abd72081e88a063f01add42ee68d540 100644
--- a/aosp_barbet.mk
+++ b/aosp_barbet.mk
@@ -48,14 +48,14 @@ $(call inherit-product-if-exists, vendor/google_devices/barbet/prebuilts/device-
 # Don't build super.img.
 PRODUCT_BUILD_SUPER_PARTITION := false
 
 # b/113232673 STOPSHIP deal with Qualcomm stuff later
 # PRODUCT_RESTRICT_VENDOR_FILES := all
 
 # b/189477034: Bypass build time check on uses_libs until vendor fixes all their apps
 PRODUCT_BROKEN_VERIFY_USES_LIBRARIES := true
 
 PRODUCT_MANUFACTURER := Google
-PRODUCT_BRAND := Android
+PRODUCT_BRAND := google
 PRODUCT_NAME := aosp_barbet
 PRODUCT_DEVICE := barbet
 PRODUCT_MODEL := Pixel 5a

commit e1f552f3645988213aeaea9d6b6081b2aa29e0b9
Author: flawedworld <flawedworld@flawed.world>
Date:   Fri 2021-08-27 19:37:54+0000

    remove aosp_ prefix from product name
---
 AndroidProducts.mk | 4 ++--
 barbet.mk (new)    | 5 +++++
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/AndroidProducts.mk b/AndroidProducts.mk
index 3b291cd207221c2285bf7f4b818e5f6664257785..9657d57c16a588079b7bc1aa88c95b7e8f537771 100644
--- a/AndroidProducts.mk
+++ b/AndroidProducts.mk
@@ -8,14 +8,14 @@
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 
 PRODUCT_MAKEFILES := \
-    $(LOCAL_DIR)/aosp_barbet.mk \
+    $(LOCAL_DIR)/barbet.mk \
 
 COMMON_LUNCH_CHOICES := \
-    aosp_barbet-userdebug \
+    barbet-userdebug \
diff --git a/barbet.mk b/barbet.mk
new file mode 100644
index 0000000000000000000000000000000000000000..fd345f3bcb9e2430f9cfd340b2cdcf371f586127
--- /dev/null
+++ b/barbet.mk
@@ -0,0 +1,5 @@
+# Inherit AOSP product configuration
+$(call inherit-product, device/google/barbet/aosp_barbet.mk)
+
+# Remove AOSP prefix from product name
+PRODUCT_NAME := barbet

commit fc0c4f1dbe5351ff98231f278849c2574d7cd2a4
Author: flawedworld <flawedworld@flawed.world>
Date:   Fri 2021-08-27 19:38:06+0000

    Move to monolithic kernel builds
---
 init.insmod.barbet.cfg | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/init.insmod.barbet.cfg b/init.insmod.barbet.cfg
index f2728df28091a374ff6bfa6e4e50f3695420e722..3ea3d56fe191c4adfe5b62661987a17d4cbb4f95 100644
--- a/init.insmod.barbet.cfg
+++ b/init.insmod.barbet.cfg
@@ -1,19 +1,15 @@
 #############################################
 #           init.insmod.cfg                 #
 # This file contains kernel modules to load #
 # at init time by init.insmod.sh script     #
 #############################################
 
-# Load kernel modules
-modprobe|-b *
-modprobe|ftm5.ko
-
 # All modules loaded
 setprop|vendor.all.modules.ready
 
 # Boot devices
 enable|/sys/kernel/boot_adsp/boot
 enable|/sys/kernel/boot_cdsp/boot
 
 # All devices enabled
 setprop|vendor.all.devices.ready

commit f0aec2ef5fc897f415c4f68f972dc66266c3f8ae
Author: flawedworld <flawedworld@flawed.world>
Date:   Fri 2021-08-27 19:38:42+0000

    specify TARGET_PREBUILT_KERNEL
---
 device-barbet.mk | 1 +
 1 file changed, 1 insertion(+)

diff --git a/device-barbet.mk b/device-barbet.mk
index 9df346def39c392b5f9117ebb11c2379085b54cc..7460564b51edb380ddb2cb12cf2ce1a06bf14022 100644
--- a/device-barbet.mk
+++ b/device-barbet.mk
@@ -9,20 +9,21 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 
 PRODUCT_HARDWARE := barbet
 
+TARGET_PREBUILT_KERNEL := device/google/barbet-kernel/Image.lz4
 ifeq ($(TARGET_PREBUILT_KERNEL),)
     ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
         LOCAL_KERNEL := device/google/barbet-kernel/Image.lz4
     else
         LOCAL_KERNEL := device/google/barbet-kernel/vintf/Image.lz4
     endif
 else
     LOCAL_KERNEL := $(TARGET_PREBUILT_KERNEL)
 endif
 

commit 1da11ba55fbeb83077523d7994c25fcc33231016
Author: flawedworld <flawedworld@flawed.world>
Date:   Tue 2021-09-07 23:47:41+0000

    Add the set of PIXEL_*_EXPERIENCE features for barbet
---
 device-barbet.mk            |  4 ++++
 google_experience.xml (new) | 13 +++++++++++++
 2 files changed, 17 insertions(+)

diff --git a/device-barbet.mk b/device-barbet.mk
index 7460564b51edb380ddb2cb12cf2ce1a06bf14022..8efcf64321f98333d48031bf48a67c1355848fed 100644
--- a/device-barbet.mk
+++ b/device-barbet.mk
@@ -201,10 +201,14 @@ PRODUCT_PRODUCT_PROPERTIES += \
 PRODUCT_PACKAGES += \
     NoCutoutOverlay \
     AvoidAppsInCutoutOverlay
 
 PRODUCT_COPY_FILES += \
     device/google/barbet/default-permissions.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/default-permissions/default-permissions.xml
 
 # (b/183612348): Enable skia reduceOpsTaskSplitting
 PRODUCT_PROPERTY_OVERRIDES += \
     renderthread.skia.reduceopstasksplitting=true
+
+# Set of *_EXPERIENCE features for barbet
+PRODUCT_COPY_FILES += \
+    $(LOCAL_PATH)/google_experience.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/sysconfig/google_experience.xml
diff --git a/google_experience.xml b/google_experience.xml
new file mode 100644
index 0000000000000000000000000000000000000000..501f8b6dbdde9a5e913184df02ac6f52de6c58dc
--- /dev/null
+++ b/google_experience.xml
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<config>
+    <feature name="com.google.android.feature.GOOGLE_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2017_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2018_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2019_MIDYEAR_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2019_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2020_MIDYEAR_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2020_EXPERIENCE" />
+    <feature name="com.google.android.feature.PIXEL_2021_MIDYEAR_EXPERIENCE" />
+</config>

commit 33f0cc586e357a26fdfe010b83a111383bcf3d19
Author: flawedworld <flawedworld@flawed.world>
Date:   Sun 2021-10-10 00:31:36+0100

    Add vendor soong namespace
---
 aosp_barbet.mk | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/aosp_barbet.mk b/aosp_barbet.mk
index cdff73414abd72081e88a063f01add42ee68d540..4020de5988a44de97e0eab298253ff40310ec344 100644
--- a/aosp_barbet.mk
+++ b/aosp_barbet.mk
@@ -7,20 +7,22 @@
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 
+PRODUCT_SOONG_NAMESPACES += vendor/google_devices/barbet
+
 #
 # All components inherited here go to system image
 #
 $(call inherit-product, $(SRC_TARGET_DIR)/product/core_64_bit.mk)
 $(call inherit-product, $(SRC_TARGET_DIR)/product/generic_system.mk)
 
 # Enable mainline checking
 PRODUCT_ENFORCE_ARTIFACT_PATH_REQUIREMENTS := strict
 
 #

commit cdf26547546efa51d5d1fa7ba26e8ae8d8614064 (HEAD, tag: SQ1A.220205.002.2022020800, m/master, grapheneos/12)
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Tue 2021-10-26 09:19:46-0400

    temporarily disable broken AvoidAppsInCutoutOverlay
---
 device-barbet.mk | 1 -
 1 file changed, 1 deletion(-)

diff --git a/device-barbet.mk b/device-barbet.mk
index 8efcf64321f98333d48031bf48a67c1355848fed..4897b5c48f825b65dee2a55d7bcbfaebaeffead7 100644
--- a/device-barbet.mk
+++ b/device-barbet.mk
@@ -193,21 +193,20 @@ PRODUCT_PACKAGES += \
     SettingsOverlayG025H \
     SettingsOverlayG4S1M \
     SettingsOverlayG1F8F
 
 # Set support hide display cutout feature
 PRODUCT_PRODUCT_PROPERTIES += \
     ro.support_hide_display_cutout=true
 
 PRODUCT_PACKAGES += \
     NoCutoutOverlay \
-    AvoidAppsInCutoutOverlay
 
 PRODUCT_COPY_FILES += \
     device/google/barbet/default-permissions.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/default-permissions/default-permissions.xml
 
 # (b/183612348): Enable skia reduceOpsTaskSplitting
 PRODUCT_PROPERTY_OVERRIDES += \
     renderthread.skia.reduceopstasksplitting=true
 
 # Set of *_EXPERIENCE features for barbet
 PRODUCT_COPY_FILES += \

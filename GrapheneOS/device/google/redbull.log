commit 8307cf284bcdf19b24f816496c30a14325d52b65
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Wed 2020-10-14 19:16:12-0400

    disable system_other odex
---
 device-common.mk | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/device-common.mk b/device-common.mk
index 1fdb13008bd524be092c6875b80c14b133843a4d..11287222afc70e4c645708b350e16812b6e480a7 100644
--- a/device-common.mk
+++ b/device-common.mk
@@ -126,40 +126,36 @@ ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
 else
   PRODUCT_COPY_FILES += \
       $(LOCAL_PATH)/init.hardware.mpssrfs.rc.user:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.$(PRODUCT_PLATFORM).mpssrfs.rc
   PRODUCT_COPY_FILES += \
       $(LOCAL_PATH)/init.hardware.diag.rc.user:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.$(PRODUCT_PLATFORM).diag.rc
 endif
 
 # A/B support
 PRODUCT_PACKAGES += \
     otapreopt_script \
-    cppreopts.sh \
     update_engine \
     update_verifier
 
 PRODUCT_PACKAGES += \
     e2fsck_ramdisk \
     tune2fs_ramdisk \
     resize2fs_ramdisk
 
 # Use Sdcardfs
 PRODUCT_PRODUCT_PROPERTIES += \
     ro.sys.sdcardfs=1
 
 PRODUCT_PACKAGES += \
     bootctrl.lito \
     bootctrl.lito.recovery
 
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.cp_system_other_odex=1
-
 AB_OTA_POSTINSTALL_CONFIG += \
     RUN_POSTINSTALL_system=true \
     POSTINSTALL_PATH_system=system/bin/otapreopt_script \
     FILESYSTEM_TYPE_system=ext4 \
     POSTINSTALL_OPTIONAL_system=true
 
 PRODUCT_PACKAGES += \
     update_engine_sideload \
     sg_write_buffer \
     f2fs_io \

commit d3e8fc6342a046545d75d98391cd7b5bfb5c1ef8
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Wed 2020-10-14 19:16:59-0400

    SystemUIGoogle -> SystemUI
---
 device-common.mk                                       | 2 +-
 overlay/frameworks/base/core/res/res/values/config.xml | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/device-common.mk b/device-common.mk
index 11287222afc70e4c645708b350e16812b6e480a7..029d3f17d24a3700f1c8173c535f5efd8961b6c4 100644
--- a/device-common.mk
+++ b/device-common.mk
@@ -745,21 +745,21 @@ PRODUCT_PROPERTY_OVERRIDES += \
 
 # Enable tcpdump_logger on userdebug and eng
 ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
     PRODUCT_PROPERTY_OVERRIDES += \
         persist.vendor.tcpdump.log.alwayson=false \
         persist.vendor.tcpdump.log.br_num=5
 endif
 
 # Preopt SystemUI
 PRODUCT_DEXPREOPT_SPEED_APPS += \
-    SystemUIGoogle
+    SystemUI
 
 # Enable stats logging in LMKD
 TARGET_LMKD_STATS_LOG := true
 PRODUCT_PRODUCT_PROPERTIES += \
     ro.lmk.log_stats=true
 
 PRODUCT_COPY_FILES += \
     $(LOCAL_PATH)/init.gadgethal.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.gadgethal.sh
 
 # default usb oem functions
diff --git a/overlay/frameworks/base/core/res/res/values/config.xml b/overlay/frameworks/base/core/res/res/values/config.xml
index 974f39d89cbea95d16505c03ae84f2de893c584e..9ef69ecc2128fa848957a3ef325696c0bcdd6222 100755
--- a/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/overlay/frameworks/base/core/res/res/values/config.xml
@@ -282,22 +282,22 @@
         <item>"/apex/com.android.art/javalib/arm64/boot.oat"</item>
         <item>"/apex/com.android.art/javalib/arm64/boot-core-libart.oat"</item>
         <item>"/apex/com.android.art/javalib/core-oj.jar"</item>
         <item>"/apex/com.android.art/javalib/core-libart.jar"</item>
         <item>"/apex/com.android.media/javalib/updatable-media.jar"</item>
         <item>"/system/framework/framework.jar"</item>
         <item>"/system/framework/services.jar"</item>
         <item>"/system/framework/arm64/boot-framework.oat"</item>
         <item>"/system/framework/oat/arm64/services.odex"</item>
         <item>"/system/lib64/libsurfaceflinger.so"</item>
-        <item>"/system_ext/priv-app/SystemUIGoogle/SystemUIGoogle.apk"</item>
-        <item>"/system_ext/priv-app/SystemUIGoogle/oat/arm64/SystemUIGoogle.odex"</item>
+        <item>"/system_ext/priv-app/SystemUI/SystemUI.apk"</item>
+        <item>"/system_ext/priv-app/SystemUI/oat/arm64/SystemUI.odex"</item>
         <item>"/vendor/lib64/lib_aion_buffer.so"</item>
         <item>"/vendor/lib64/libcamxexternalformatutils.so"</item>
         <item>"/vendor/lib64/libipebpsstriping.so"</item>
         <item>"/vendor/lib64/libCB.so"</item>
         <item>"/vendor/lib64/libgsl.so"</item>
     </string-array>
 
     <!-- Should the pinner service pin the Camera application? -->
     <bool name="config_pinnerCameraApp">true</bool>
 

commit 63737f4f0f388eb0cdd786ef52d54db45432898e
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Wed 2020-10-14 19:17:25-0400

    raise maximum users to 16
---
 overlay/frameworks/base/core/res/res/values/config.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/overlay/frameworks/base/core/res/res/values/config.xml b/overlay/frameworks/base/core/res/res/values/config.xml
index 9ef69ecc2128fa848957a3ef325696c0bcdd6222..93061db494049523cbc33b16fee7a2c57a671a8e 100755
--- a/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/overlay/frameworks/base/core/res/res/values/config.xml
@@ -114,21 +114,21 @@
     <!-- Set to true to add links to Cell Broadcast app from Settings and MMS app. -->
     <bool name="config_cellBroadcastAppLinks">true</bool>
 
     <!-- reference volume index for music stream to limit headphone volume and display warning -->
     <integer name="config_safe_media_volume_index">7</integer>
 
     <!--  Whether Multiuser UI should be shown -->
     <bool name="config_enableMultiUserUI">true</bool>
 
     <!--  Maximum number of supported users -->
-    <integer name="config_multiuserMaximumUsers">4</integer>
+    <integer name="config_multiuserMaximumUsers">16</integer>
 
     <!-- Whether Hearing Aid profile is supported -->
     <bool name="config_hearing_aid_profile_supported">true</bool>
 
     <!-- List of regexpressions describing the interface (if any) that represent tetherable
          USB interfaces.  If the device doesn't want to support tething over USB this should
          be empty.  An example would be "usb.*" -->
     <string-array translatable="false" name="config_tether_usb_regexs">
         <item>"usb\\d"</item>
         <item>"rndis\\d"</item>

commit 5065f62b6ff3b2efd9e0171c868f87fb7a15a4bb
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Wed 2020-10-14 19:17:50-0400

    disable GSI keys
---
 device-common.mk | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/device-common.mk b/device-common.mk
index 029d3f17d24a3700f1c8173c535f5efd8961b6c4..7ce2754a7705006747d56ebe2db6ce51dcb1b94d 100644
--- a/device-common.mk
+++ b/device-common.mk
@@ -83,23 +83,20 @@ PRODUCT_PROPERTY_OVERRIDES += \
     ro.control_privapp_permissions=enforce
 
 PRODUCT_PACKAGES += \
     messaging \
     dmabuf_dump
 
 TARGET_PRODUCT_PROP := $(LOCAL_PATH)/product.prop
 
 $(call inherit-product, $(LOCAL_PATH)/utils.mk)
 
-# Installs gsi keys into ramdisk, to boot a developer GSI with verified boot.
-$(call inherit-product, $(SRC_TARGET_DIR)/product/developer_gsi_keys.mk)
-
 PRODUCT_CHARACTERISTICS := nosdcard
 PRODUCT_SHIPPING_API_LEVEL := 30
 
 DEVICE_PACKAGE_OVERLAYS += $(LOCAL_PATH)/overlay
 
 PRODUCT_COPY_FILES += \
     $(LOCAL_KERNEL):kernel \
     $(LOCAL_PATH)/fstab.hardware:$(TARGET_COPY_OUT_RECOVERY)/root/first_stage_ramdisk/fstab.$(PRODUCT_PLATFORM) \
     $(LOCAL_PATH)/fstab.hardware:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.$(PRODUCT_PLATFORM) \
     $(LOCAL_PATH)/fstab.hardware:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.$(PRODUCT_PLATFORM) \

commit ffcc94ef3d8bc022b2724567bd3cdaff2cf82c42
Author: Artem Borisov <dedsa2002@gmail.com>
Date:   Fri 2020-11-20 11:32:37+0000

    redbull: Switch to monolithic kernel builds
    
    Change-Id: Ibbba891cc1cee34611c9e03b431e6b998a35bd40
---
 BoardConfig-common.mk | 328 +-------------------------------------------------
 1 file changed, 3 insertions(+), 325 deletions(-)

diff --git a/BoardConfig-common.mk b/BoardConfig-common.mk
index 8e9ad5fb852c8b1556ed7155ad49d93a90b59daa..9d24b2e50331eedc38bd31651ef28ce81e483444 100644
--- a/BoardConfig-common.mk
+++ b/BoardConfig-common.mk
@@ -102,251 +102,20 @@ BOARD_PERSISTIMAGE_FILE_SYSTEM_TYPE := ext4
 
 # boot.img
 BOARD_BOOTIMAGE_PARTITION_SIZE := 0x06000000
 
 # vendor_boot.img
 BOARD_VENDOR_BOOTIMAGE_PARTITION_SIZE := 0x06000000
 
 # Allow LZ4 compression
 BOARD_RAMDISK_USE_LZ4 := true
 
-# Specify BOOT_KERNEL_MODULES
-#
-# modules for first stage in vendor_boot.img, remainder goes to vendor.img.
-# This list is a superset of all the possible modules required, and is
-# filtered and ordered as per the supplied kernel's modules.load file.
-# Any modules that do not exist will be silently dropped.  This is required
-# because some kernel configurations may have extra debug or test modules,
-# make sure any required to be loaded during first stage init are listed.
-BOOT_KERNEL_MODULES := \
-	msm_ipc_logging.ko \
-	qtee_shm_bridge.ko \
-	qcom_hwspinlock.ko \
-	smem.ko \
-	msm_minidump.ko \
-	watchdog_v2.ko \
-	early_random.ko \
-	qcom-pdc.ko \
-	cmd-db.ko \
-	qcom_rpmh.ko \
-	phy-qcom-ufs.ko \
-	phy-qcom-ufs-qrbtc-sdm845.ko \
-	phy-qcom-ufs-qmp-v4.ko \
-	phy-qcom-ufs-qmp-v4-lito.ko \
-	phy-qcom-ufs-qmp-v3-660.ko \
-	phy-qcom-ufs-qmp-v3.ko \
-	pinctrl-msm.ko \
-	pinctrl-lito.ko \
-	qcom-spmi-wled.ko \
-	msm_bus.ko \
-	clk-qcom.ko \
-	clk-aop-qmp.ko \
-	clk-rpmh.ko \
-	gcc-lito.ko \
-	clk-spmi-pmic-div.ko \
-	qrtr.ko \
-	qmi_helpers.ko \
-	secure_buffer.ko \
-	heap_mem_ext_v01.ko \
-	subsystem_notif.ko \
-	ramdump.ko \
-	msm_memshare.ko \
-	msm_bus_dbg_rpmh.ko \
-	msm_bus_rpmh.ko \
-	rpmh-regulator.ko \
-	qcom-geni-se.ko \
-	msm_geni_serial.ko \
-	msm_dma_iommu_mapping.ko \
-	arm-smmu-debug.ko \
-	iommu-logger.ko \
-	arm-smmu.ko \
-	ufshcd-core.ko \
-	ufshcd-pltfrm.ko \
-	ufs_qcom.ko \
-	spi-geni-qcom.ko \
-	i2c-qcom-geni.ko \
-	ion-alloc.ko \
-	msm_rtb.ko \
-	pinctrl-spmi-gpio.ko \
-	pinctrl-spmi-mpp.ko \
-	pwm-qti-lpg.ko \
-	debugcc-lito.ko \
-	dispcc-lito.ko \
-	gpucc-lito.ko \
-	npucc-lito.ko \
-	videocc-lito.ko \
-	virt-dma.ko \
-	gpi.ko \
-	msm_scm.ko \
-	mdt_loader.ko \
-	smem_state.ko \
-	smp2p.ko \
-	qcom_ipcc.ko \
-	llcc-slice.ko \
-	llcc-lito.ko \
-	core_hang_detect.ko \
-	gladiator_hang_detect.ko \
-	minidump_log.ko \
-	memory_dump_v2.ko \
-	dcc_v2.ko \
-	service-locator.ko \
-	service-notifier.ko \
-	subsystem-restart.ko \
-	peripheral-loader.ko \
-	subsys-pil-tz.ko \
-	cdsp-loader.ko \
-	qseecom.ko \
-	smcinvoke.ko \
-	microdump_collector.ko \
-	eud.ko \
-	qcom_socinfo.ko \
-	fsa4480-i2c.ko \
-	rpmsg_core.ko \
-	qcom_glink_native.ko \
-	qcom_glink_smem.ko \
-	qcom_glink_spss.ko \
-	glink_probe.ko \
-	glink_pkt.ko \
-	smp2p_sleepstate.ko \
-	event_timer.ko \
-	lpm-stats.ko \
-	msm_pm.ko \
-	rpmh_master_stat.ko \
-	system_pm.ko \
-	rpm_stats.ko \
-	ddr_stats.ko \
-	cdsprm.ko \
-	msm_icnss.ko \
-	modemsmem.ko \
-	qpnp-amoled-regulator.ko \
-	refgen.ko \
-	slg51000-regulator.ko \
-	tps-regulator.ko \
-	msm_rng.ko \
-	adsprpc_compat.ko \
-	adsprpc.ko \
-	fastcvpd.ko \
-	rdbg.ko \
-	qpnp-power-on.ko \
-	msm-poweroff.ko \
-	usb_f_diag.ko \
-	diagchar.ko \
-	governor_bw_vbif.ko \
-	governor_gpubw_mon.ko \
-	governor_msm_adreno_tz.ko \
-	msm_adreno.ko \
-	regmap-spmi.ko \
-	google-bms.ko \
-	at24.ko \
-	hdcp_qseecom.ko \
-	msm_hdcp.ko \
-	citadel-spi.ko \
-	qcom-i2c-pmic.ko \
-	qcom-spmi-pmic.ko \
-	st21nfc.ko \
-	st54j_se.ko \
-	qpnp-revid.ko \
-	devfreq_qcom_fw.ko \
-	adc_tm.ko \
-	msm_sps.ko \
-	qce50.ko \
-	qcedev-module.ko \
-	qcrypto.ko \
-	spmi-pmic-arb.ko \
-	cnss_utils.ko \
-	cnss_prealloc.ko \
-	cnss_nl.ko \
-	msm_sharedmem.ko \
-	phy-generic.ko \
-	phy-msm-ssusb-qmp.ko \
-	phy-msm-snps-hs.ko \
-	xhci-plat-hcd.ko \
-	rndis.ko \
-	usb_f_cdev.ko \
-	usb_f_ccid.ko \
-	dwc3.ko \
-	usb-dwc3-msm.ko \
-	usb_f_qdss.ko \
-	msm_gsi.ko \
-	ipa3.ko \
-	usb_f_gsi.ko \
-	usb_f_mtp.ko \
-	usb_f_ptp.ko \
-	roles.ko \
-	tcpm.ko \
-	logbuffer.ko \
-	pmic-voter.ko \
-	qpnp_pdphy.ko \
-	dwc3-haps.ko \
-	dwc3-of-simple.ko \
-	dwc3-qcom.ko \
-	touchscreen_tbn.ko \
-	vd6281_module.ko \
-	fpc1020_platform_tee.ko \
-	rtc-pm8xxx.ko \
-	i2c-qcom-geni.ko \
-	devfreq_devbw.ko \
-	msm_npu.ko \
-	qpnp-battery.ko \
-	of_batterydata.ko \
-	qpnp-smb5-charger.ko \
-	qpnp-qgauge.ko \
-	sm7250_bms.ko \
-	google_charger.ko \
-	google-battery.ko \
-	overheat_mitigation.ko \
-	p9221_charger.ko \
-	qti_qmi_sensor.ko \
-	bcl_pmic5.ko \
-	bcl_soc.ko \
-	qmi_cdev.ko \
-	lmh_dbg.ko \
-	msm_lmh_dcvs.ko \
-	regulator_aop_cdev.ko \
-	cpu_isolate.ko \
-	lmh_cpu_vdd_cdev.ko \
-	qcom-spmi-temp-alarm.ko \
-	thermal-tsens.ko \
-	slimbus.ko \
-	bluetooth_power.ko \
-	qcom_edac.ko \
-	qcom-cpufreq-hw.ko \
-	leds-qpnp-flash-common.ko \
-	leds-qpnp-flash-v2.ko \
-	of_slimbus.ko \
-	tz_log.ko \
-	google_wlan_mac.ko \
-	msm_ext_display.ko \
-	msm_qmp.ko \
-	governor_bw_hwmon.ko \
-	bimc-bwmon.ko \
-	governor_memlat.ko \
-	arm-memlat-mon.ko \
-	governor_cdsp_l3.ko \
-	qcom-vadc-common.ko \
-	qcom-spmi-adc5.ko \
-	pac193x.ko \
-	qcom_llcc_pmu.ko \
-	nvmem_qfprom.ko \
-	qcom-spmi-sdam.ko \
-	slim_msm_ngd.ko \
-	rpmsg_char.ko \
-	rmnet.ko \
-	usb-audio-qmi.ko \
-	msm-vidc.ko \
-	ebtables.ko \
-	ebtable_broute.ko \
-	sctp.ko \
-	sctp_diag.ko \
-	qrtr-smd.ko \
-	msm_drm.ko \
-
 # system_ext.img
 BOARD_SYSTEM_EXTIMAGE_FILE_SYSTEM_TYPE := ext4
 
 BOARD_FLASH_BLOCK_SIZE := 131072
 
 BOARD_ROOT_EXTRA_SYMLINKS := /vendor/lib/dsp:/dsp
 BOARD_ROOT_EXTRA_SYMLINKS += /mnt/vendor/persist:/persist
 
 include device/google/redbull-sepolicy/redbull-sepolicy.mk
 
@@ -481,110 +250,19 @@ TARGET_BOARD_INFO_FILE := $(TARGET_BOARD_NAME_DIR)/board-info.txt
 TARGET_BOARD_COMMON_PATH := $(TARGET_BOARD_NAME_DIR)/sm7250
 
 # Common kernel file handling
 ifneq (,$(filter $(TARGET_DEVICE),bramble redfin))
     TARGET_KERNEL_DIR := device/google/redbull-kernel
 else
     TARGET_KERNEL_DIR := $(TARGET_BOARD_NAME_DIR:%/=%)-kernel
 endif
 
 # DTBO partition definitions
-ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
-    BOARD_PREBUILT_DTBOIMAGE := $(TARGET_KERNEL_DIR)/dtbo.img
-else
-    BOARD_PREBUILT_DTBOIMAGE := $(TARGET_KERNEL_DIR)/vintf/dtbo.img
-endif
-TARGET_FS_CONFIG_GEN := $(TARGET_BOARD_NAME_DIR)/config.fs
+BOARD_PREBUILT_DTBOIMAGE := $(TARGET_KERNEL_DIR)/dtbo.img
 
-# Kernel modules
-ifeq (,$(filter-out $(TARGET_BOOTLOADER_BOARD_NAME)_kasan, $(TARGET_PRODUCT)))
-    KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/kasan
-else ifeq (,$(filter-out $(TARGET_BOOTLOADER_BOARD_NAME)_kernel_debug_memory, $(TARGET_PRODUCT)))
-    KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/debug_memory
-else ifeq (,$(filter-out $(TARGET_BOOTLOADER_BOARD_NAME)_kernel_debug_locking, $(TARGET_PRODUCT)))
-    KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/debug_locking
-else ifeq (,$(filter-out $(TARGET_BOOTLOADER_BOARD_NAME)_kernel_debug_hang, $(TARGET_PRODUCT)))
-    KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/debug_hang
-else ifeq (,$(filter-out $(TARGET_BOOTLOADER_BOARD_NAME)_kernel_debug_api, $(TARGET_PRODUCT)))
-    KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/debug_api
-else
-    ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
-        KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)
-    else
-        KERNEL_MODULE_DIR := $(TARGET_KERNEL_DIR)/vintf
-    endif
-endif
-
-# Copy kheaders.ko to vendor/lib/modules for VTS test
-BOARD_VENDOR_KERNEL_MODULES += $(KERNEL_MODULE_DIR)/kheaders.ko
-
-KERNEL_MODULES := $(wildcard $(KERNEL_MODULE_DIR)/*.ko)
-KERNEL_MODULES_LOAD := $(strip $(shell cat $(firstword $(wildcard \
-        $(KERNEL_MODULE_DIR)/modules.load \
-        $(if $(filter userdebug eng,$(TARGET_BUILD_VARIANT)), \
-            $(TARGET_KERNEL_DIR)/vintf/modules.load,) \
-        $(TARGET_KERNEL_DIR)/modules.load))))
+TARGET_FS_CONFIG_GEN := $(TARGET_BOARD_NAME_DIR)/config.fs
 
 # DTB
-BOARD_PREBUILT_DTBIMAGE_DIR := $(KERNEL_MODULE_DIR)
-
-ifeq (,$(BOOT_KERNEL_MODULES))
-    BOARD_VENDOR_RAMDISK_KERNEL_MODULES := $(KERNEL_MODULES)
-    BOARD_VENDOR_RAMDISK_KERNEL_MODULES_LOAD := $(KERNEL_MODULES_LOAD)
-else
-    #
-    # BEWARE: This is a tuning exercise to get right, splitting between
-    # boot essential drivers, fastboot/recovery drivers, and the remainder
-    # used by Android, but not the blocklist (device specific drivers not
-    # common between platforms or drivers that must not be autoloaded) which
-    # are loaded later.
-    #
-    # BOOT_KERNEL_MODULES     - Modules loaded in first stage init.
-    # RECOVERY_KERNEL_MODULES - Additional modules loaded in recovery/fastbootd
-    #                           or in second stage init.
-    # file: modules.blocklist - Not autoloaded. loaded on demand product or HAL.
-    # Remainder               - In second stage init, but after recovery set;
-    #                           minus the blocklist.
-    #
-    BOOT_KERNEL_MODULES_FILTER := $(foreach m,$(BOOT_KERNEL_MODULES),%/$(m))
-    ifneq (,$(RECOVERY_KERNEL_MODULES))
-        RECOVERY_KERNEL_MODULES_FILTER := \
-            $(foreach m,$(RECOVERY_KERNEL_MODULES),%/$(m))
-    endif
-    BOARD_VENDOR_RAMDISK_KERNEL_MODULES += \
-            $(filter $(BOOT_KERNEL_MODULES_FILTER) \
-                     $(RECOVERY_KERNEL_MODULES_FILTER),$(KERNEL_MODULES))
-
-    # ALL modules land in /vendor/lib/modules so they could be rmmod/insmod'd,
-    # and modules.list actually limits us to the ones we intend to load.
-    BOARD_VENDOR_KERNEL_MODULES := $(KERNEL_MODULES)
-    # To limit /vendor/lib/modules to just the ones loaded, use:
-    #
-    #   BOARD_VENDOR_KERNEL_MODULES := $(filter-out \
-    #       $(BOOT_KERNEL_MODULES_FILTER),$(KERNEL_MODULES))
-
-    # Group set of /vendor/lib/modules loading order to recovery modules first,
-    # then remainder, subtracting both recovery and boot modules.
-    BOARD_VENDOR_KERNEL_MODULES_LOAD := \
-            $(filter-out $(BOOT_KERNEL_MODULES_FILTER), \
-            $(filter $(RECOVERY_KERNEL_MODULES_FILTER),$(KERNEL_MODULES_LOAD)))
-    BOARD_VENDOR_KERNEL_MODULES_LOAD += \
-            $(filter-out $(BOOT_KERNEL_MODULES_FILTER) \
-                 $(RECOVERY_KERNEL_MODULES_FILTER),$(KERNEL_MODULES_LOAD))
-
-    # NB: Load order governed by modules.load and not by $(BOOT_KERNEL_MODULES)
-    BOARD_VENDOR_RAMDISK_KERNEL_MODULES_LOAD := \
-            $(filter $(BOOT_KERNEL_MODULES_FILTER),$(KERNEL_MODULES_LOAD))
-
-    ifneq (,$(RECOVERY_KERNEL_MODULES_FILTER))
-        # Group set of /vendor/lib/modules loading order to boot modules first,
-        # then remainder of recovery modules.
-        BOARD_VENDOR_RAMDISK_RECOVERY_KERNEL_MODULES_LOAD := \
-            $(filter $(BOOT_KERNEL_MODULES_FILTER),$(KERNEL_MODULES_LOAD))
-        BOARD_VENDOR_RAMDISK_RECOVERY_KERNEL_MODULES_LOAD += \
-            $(filter-out $(BOOT_KERNEL_MODULES_FILTER), \
-            $(filter $(RECOVERY_KERNEL_MODULES_FILTER),$(KERNEL_MODULES_LOAD)))
-    endif
-endif
+BOARD_PREBUILT_DTBIMAGE_DIR := $(TARGET_KERNEL_DIR)
 
 # Testing related defines
 BOARD_PERFSETUP_SCRIPT := platform_testing/scripts/perf-setup/b5r3-setup.sh

commit 32f65d580f780cdb95005a85e5de533888eecec6
Author: anupritaisno1 <www.anuprita804@gmail.com>
Date:   Mon 2020-10-19 00:04:15+0000

    fix hw_random permissions
    
    Signed-off-by: anupritaisno1 <www.anuprita804@gmail.com>
---
 ueventd.rc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ueventd.rc b/ueventd.rc
index c04b53924c733a489c6e46f6be4a659b712a5eee..a947b2b7e582e8fad2749ae0f862d0f80c6fdee5 100644
--- a/ueventd.rc
+++ b/ueventd.rc
@@ -52,21 +52,21 @@ firmware_directories /vendor/firmware_mnt/image/
 /dev/spcom                0660   system     system
 /dev/sp_kernel            0660   system     system
 /dev/sp_ssr               0660   system     system
 /dev/sp_keymaster         0660   system     system
 /dev/sec_nvm_*            0660   system     system
 
 /dev/jpeg0                0660   system     camera
 /dev/adsprpc-smd          0664   system     system
 /dev/adsprpc-smd-secure   0644   system     system
 
-/dev/hw_random            0600   root       root
+/dev/hw_random            0440   root       system
 /dev/sdsprpc-smd          0660   system     system
 
 /dev/wcd-dsp-glink        0660   system     audio
 /dev/wcd_dsp0_control     0660   system     audio
 /dev/wcd-spi-ac-client    0660   system     audio
 /dev/iaxxx-odsp-celldrv   0660   system     audio
 /dev/tunnel0              0660   system     audio
 
 /dev/msm_qcelp            0660   system     audio
 /dev/msm_evrc             0660   system     audio

commit 19776c9ddcd3574be7963c6dbd6439fc8819cf1f
Author: Artem Borisov <dedsa2002@gmail.com>
Date:   Wed 2020-07-22 18:40:15+0000

    redbull: Trigger boot_wlan on boot
    
    Signed-off-by: anupritaisno1 <www.anuprita804@gmail.com>
    Change-Id: Id8f0dc92733625656ad19463ae2fa685178242da
---
 init.hardware.rc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/init.hardware.rc b/init.hardware.rc
index 288990e5bb7ab82f090262503250e938e425c4fa..660829d37d1cf943890a4d87bf84ee09ade67800 100644
--- a/init.hardware.rc
+++ b/init.hardware.rc
@@ -362,20 +362,23 @@ on zygote-start
     mkdir /data/vendor/location/mq 0770 gps gps
     mkdir /data/vendor/location/xtwifi 0770 gps gps
     mkdir /dev/socket/location 0770 gps gps
     mkdir /dev/socket/location/mq 0770 gps gps
     mkdir /dev/socket/location/xtra 0770 gps gps
 
     #Create directories for wifihal services
     mkdir /dev/socket/wifihal 0770 wifi wifi
     chmod 2770 /dev/socket/wifihal
 
+    # Trigger WLAN driver load
+    write /sys/kernel/boot_wlan/boot_wlan 1
+
 on early-boot
     # Change owner for sensors-related directories
     chown root system /mnt/vendor/persist/sensors/registry
     chown root system /mnt/vendor/persist/sensors/registry/registry
     chown system root /mnt/vendor/persist/sensors/sensors_settings
     chown root root /mnt/vendor/persist/sensors/registry/registry/sensors_settings
 
     # Set up sensors-related data directories and permissions
     mkdir /data/vendor/sensors 0770
     chown system system /data/vendor/sensors

commit 1d670ca464da3e2471107f226119163e86602c40
Author: anupritaisno1 <www.anuprita804@gmail.com>
Date:   Sun 2020-10-18 22:58:30+0000

    Add config overlay for biometric sensors
    
    This is needed to make biometric authentication prompts in third-party apps work on Android 11
    
    Signed-off-by: anupritaisno1 <www.anuprita804@gmail.com>
---
 overlay/frameworks/base/core/res/res/values/config.xml | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/overlay/frameworks/base/core/res/res/values/config.xml b/overlay/frameworks/base/core/res/res/values/config.xml
index 93061db494049523cbc33b16fee7a2c57a671a8e..58fb5fcc0ce34ae5fa61d2481a4beb5a53e7468a 100755
--- a/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/overlay/frameworks/base/core/res/res/values/config.xml
@@ -355,11 +355,20 @@
     <!-- What source to use to estimate link upstream and downstream bandwidth capacities.
       Default is carrier_config, but it should be set to modem if the modem is returning
       predictive (instead of instantaneous) bandwidth estimates.
       Values are carrier_config and modem. -->
     <string name="config_bandwidthEstimateSource">modem</string>
 
     <!-- Delay that allows some content to arrive at the display before switching
          from DOZE to ON, in millis. -->
     <integer name="config_wakeUpDelayDoze">32</integer>
 
+    <!-- List of biometric sensors on the device, in decreasing strength. Consumed by AuthService
+         when registering authenticators with BiometricService. Format must be ID:Modality:Strength,
+         where: IDs are unique per device, Modality as defined in BiometricAuthenticator.java,
+         and Strength as defined in Authenticators.java -->
+    <string-array name="config_biometric_sensors" translatable="false" >
+        <!-- ID0:Fingerprint:Strong -->
+        <item>0:2:15</item>
+    </string-array>
+
 </resources>

commit e9b9cdbd6d21d44dd330346a211ef1464b5bca9f
Author: anupritaisno1 <www.anuprita804@gmail.com>
Date:   Sat 2020-11-14 02:09:38+0000

    redbull: disable chained vbmeta
    
    Signed-off-by: anupritaisno1 <www.anuprita804@gmail.com>
    Change-Id: Iba8e6a3a2ee9e969e90ca422d85355b212d02634
---
 BoardConfig-common.mk | 8 --------
 fstab.hardware        | 6 +++---
 2 files changed, 3 insertions(+), 11 deletions(-)

diff --git a/BoardConfig-common.mk b/BoardConfig-common.mk
index 9d24b2e50331eedc38bd31651ef28ce81e483444..6d588cc07e5defbc5db4cfb6388116de74386787 100644
--- a/BoardConfig-common.mk
+++ b/BoardConfig-common.mk
@@ -63,38 +63,30 @@ BOARD_USES_METADATA_PARTITION := true
 
 AB_OTA_UPDATER := true
 
 AB_OTA_PARTITIONS += \
     boot \
     vendor_boot \
     system \
     vbmeta \
     dtbo \
     product \
-    vbmeta_system \
     system_ext
 
 # Partitions (listed in the file) to be wiped under recovery.
 TARGET_RECOVERY_WIPE := device/google/redbull/recovery.wipe
 TARGET_RECOVERY_FSTAB := device/google/redbull/fstab.hardware
 TARGET_RECOVERY_PIXEL_FORMAT := RGBX_8888
 TARGET_RECOVERY_UI_LIB := \
     librecovery_ui_pixel \
     libfstab
 
-# Enable chain partition for system.
-BOARD_AVB_VBMETA_SYSTEM := system
-BOARD_AVB_VBMETA_SYSTEM_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_VBMETA_SYSTEM_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_VBMETA_SYSTEM_ROLLBACK_INDEX := $(PLATFORM_SECURITY_PATCH_TIMESTAMP)
-BOARD_AVB_VBMETA_SYSTEM_ROLLBACK_INDEX_LOCATION := 1
-
 # product.img
 BOARD_PRODUCTIMAGE_FILE_SYSTEM_TYPE := ext4
 
 # userdata.img
 TARGET_USERIMAGES_USE_F2FS := true
 BOARD_USERDATAIMAGE_PARTITION_SIZE := 10737418240
 BOARD_USERDATAIMAGE_FILE_SYSTEM_TYPE := f2fs
 
 # persist.img
 BOARD_PERSISTIMAGE_PARTITION_SIZE := 33554432
diff --git a/fstab.hardware b/fstab.hardware
index cdf6bd90615387c43769a9fc83cad55a6c7daad8..b5395725ab8b5fe9a0cd8d5aeac0d48b363d1471 100644
--- a/fstab.hardware
+++ b/fstab.hardware
@@ -1,12 +1,12 @@
 # Android fstab file.
 
 #<src>                                                  <mnt_point>            <type>  <mnt_flags and options>                              <fs_mgr_flags>
-system                                                  /system                ext4    ro,barrier=1                                         wait,slotselect,avb=vbmeta_system,logical,first_stage_mount
-system_ext                                              /system_ext            ext4    ro,barrier=1                                         wait,slotselect,avb=vbmeta_system,logical,first_stage_mount
-vendor                                                  /vendor                ext4    ro,barrier=1                                         wait,slotselect,avb=vbmeta,logical,first_stage_mount
+system                                                  /system                ext4    ro,barrier=1                                         wait,slotselect,avb=vbmeta,logical,first_stage_mount
+system_ext                                              /system_ext            ext4    ro,barrier=1                                         wait,slotselect,avb,logical,first_stage_mount
+vendor                                                  /vendor                ext4    ro,barrier=1                                         wait,slotselect,avb,logical,first_stage_mount
 product                                                 /product               ext4    ro,barrier=1                                         wait,slotselect,avb,logical,first_stage_mount
 /dev/block/by-name/metadata                             /metadata              ext4    noatime,nosuid,nodev,discard,sync                    wait,formattable,first_stage_mount,check,metadata_csum
 /dev/block/bootdevice/by-name/misc                      /misc                  emmc    defaults                                             defaults
 /dev/block/bootdevice/by-name/userdata                  /data                  f2fs    noatime,nosuid,nodev,discard,reserve_root=32768,resgid=1065,fsync_mode=nobarrier,inlinecrypt       latemount,wait,check,quota,formattable,fileencryption=aes-256-xts:aes-256-cts:v2+inlinecrypt_optimized,reservedsize=128M,sysfs_path=/sys/devices/platform/soc/1d84000.ufshc,keydirectory=/metadata/vold/metadata_encryption,checkpoint=fs
 /devices/platform/soc/a600000.ssusb/a600000.dwc3*       auto                   vfat    defaults                                             voldmanaged=usb:auto
 /dev/block/zram0                                        none                   swap    defaults                                             zramsize=2147483648,max_comp_streams=8,zram_backingdev_size=512M

commit 5a754510545b19310a1eab7fbb41c38df231346b
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Thu 2021-02-11 22:30:29-0500

    set boot security patch level
---
 device-common.mk | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/device-common.mk b/device-common.mk
index 7ce2754a7705006747d56ebe2db6ce51dcb1b94d..9ba60c459a83aa41ebe1c9856db106c97afe2fb1 100644
--- a/device-common.mk
+++ b/device-common.mk
@@ -842,20 +842,22 @@ endif
 
 PRODUCT_COPY_FILES += \
     $(LOCAL_PATH)/powerhint.json:$(TARGET_COPY_OUT_VENDOR)/etc/powerhint.json
 
 PRODUCT_COPY_FILES += \
     $(LOCAL_PATH)/task_profiles.json:$(TARGET_COPY_OUT_VENDOR)/etc/task_profiles.json
 
 # Set Vendor SPL to match platform
 VENDOR_SECURITY_PATCH = $(PLATFORM_SECURITY_PATCH)
 
+BOOT_SECURITY_PATCH = $(PLATFORM_SECURITY_PATCH)
+
 PRODUCT_PROPERTY_OVERRIDES += vendor.audio.adm.buffering.ms=3
 PRODUCT_PROPERTY_OVERRIDES += vendor.audio_hal.period_multiplier=2
 PRODUCT_PROPERTY_OVERRIDES += af.fast_track_multiplier=1
 
 # Enable AAudio MMAP/NOIRQ data path.
 # 1 is AAUDIO_POLICY_NEVER  means only use Legacy path.
 # 2 is AAUDIO_POLICY_AUTO   means try MMAP then fallback to Legacy path.
 # 3 is AAUDIO_POLICY_ALWAYS means only use MMAP path.
 PRODUCT_PROPERTY_OVERRIDES += aaudio.mmap_policy=2
 # 1 is AAUDIO_POLICY_NEVER  means only use SHARED mode

commit 16eec8c3657f210e602ef132b93d87f74a1fc8b6
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Tue 2021-03-02 05:48:10-0500

    use specialized kernel builds
---
 BoardConfig-common.mk | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/BoardConfig-common.mk b/BoardConfig-common.mk
index 6d588cc07e5defbc5db4cfb6388116de74386787..0a747336044e7755a130a797c67c8d7af5e9cb46 100644
--- a/BoardConfig-common.mk
+++ b/BoardConfig-common.mk
@@ -235,25 +235,21 @@ PRODUCT_COPY_FILES += \
 
 # TARGET_BOOLOADER_BOARD_NAME sensitive common boilerplate
 
 TARGET_BOARD_NAME_DIR := device/google/$(TARGET_BOOTLOADER_BOARD_NAME)
 -include $(TARGET_BOARD_NAME_DIR:%/=%)-sepolicy/$(TARGET_BOOTLOADER_BOARD_NAME)-sepolicy.mk
 
 TARGET_BOARD_INFO_FILE := $(TARGET_BOARD_NAME_DIR)/board-info.txt
 TARGET_BOARD_COMMON_PATH := $(TARGET_BOARD_NAME_DIR)/sm7250
 
 # Common kernel file handling
-ifneq (,$(filter $(TARGET_DEVICE),bramble redfin))
-    TARGET_KERNEL_DIR := device/google/redbull-kernel
-else
-    TARGET_KERNEL_DIR := $(TARGET_BOARD_NAME_DIR:%/=%)-kernel
-endif
+TARGET_KERNEL_DIR := $(TARGET_BOARD_NAME_DIR:%/=%)-kernel
 
 # DTBO partition definitions
 BOARD_PREBUILT_DTBOIMAGE := $(TARGET_KERNEL_DIR)/dtbo.img
 
 TARGET_FS_CONFIG_GEN := $(TARGET_BOARD_NAME_DIR)/config.fs
 
 # DTB
 BOARD_PREBUILT_DTBIMAGE_DIR := $(TARGET_KERNEL_DIR)
 
 # Testing related defines

commit f933a96b3bc88e65532984702ea416b73fceabab (HEAD, tag: RQ2A.210505.002.2021.05.04.01, m/master)
Author: razorloves <razorloves@gmail.com>
Date:   Tue 2020-05-12 23:50:50-0500

    redbull: Set slotId# of non-removable esim
    
    This is needed for esim to function properly.
    Without it the EID value could not be read.
    
    Change-Id: I414a7c98362523c5880cfa90b6ce9c0ce92e9c32
---
 .../base/core/res/res/values/arrays.xml (new)      | 37 ++++++++++++++++++++++
 1 file changed, 37 insertions(+)

diff --git a/overlay/frameworks/base/core/res/res/values/arrays.xml b/overlay/frameworks/base/core/res/res/values/arrays.xml
new file mode 100644
index 0000000000000000000000000000000000000000..333bb3248d690c8fdeef553d5dbb801ca1da0a5a
--- /dev/null
+++ b/overlay/frameworks/base/core/res/res/values/arrays.xml
@@ -0,0 +1,37 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2021, The LineageOS Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <!-- Device-specific array of SIM slot indexes which are are embedded eUICCs.
+         e.g. If a device has two physical slots with indexes 0, 1, and slot 1 is an
+         eUICC, then the value of this array should be:
+             <integer-array name="non_removable_euicc_slots">
+                 <item>1</item>
+             </integer-array>
+         If a device has three physical slots and slot 1 and 2 are eUICCs, then the value of
+         this array should be:
+             <integer-array name="non_removable_euicc_slots">
+                <item>1</item>
+                <item>2</item>
+             </integer-array>
+         This is used to differentiate between removable eUICCs and built in eUICCs, and should
+         be set by OEMs for devices which use eUICCs. -->
+    <integer-array name="non_removable_euicc_slots">
+        <item>1</item>
+    </integer-array>
+</resources>

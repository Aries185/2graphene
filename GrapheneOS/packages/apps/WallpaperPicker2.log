commit b0783bea70155cf23e738fb50236d960e54b324e (tag: SQ1A.220105.002.2022010500)
Author: Danny Lin <danny@kdrag0n.dev>
Date:   Tue 2020-12-15 18:58:04-0800

    WallpaperPicker2: Don't publish placeholder categories
    
    Publishing a placeholder category causes the real category to never
    appear, even after it's done loading.
    
    Change-Id: If14630ed4a98f843f7c310984380e919776d6827
---
 src/com/android/wallpaper/module/DefaultCategoryProvider.java | 6 ------
 1 file changed, 6 deletions(-)

diff --git a/src/com/android/wallpaper/module/DefaultCategoryProvider.java b/src/com/android/wallpaper/module/DefaultCategoryProvider.java
index e82045de7d7af114cac139fd90577d3c9d33c23b..30e5c4dad37ba48cf73c7eff1997b5c1a833d26a 100755
--- a/src/com/android/wallpaper/module/DefaultCategoryProvider.java
+++ b/src/com/android/wallpaper/module/DefaultCategoryProvider.java
@@ -302,43 +302,37 @@ public class DefaultCategoryProvider implements CategoryProvider {
                 while (((type = parser.next()) != XmlPullParser.END_TAG
                         || parser.getDepth() > depth) && type != XmlPullParser.END_DOCUMENT) {
                     if ((type == XmlPullParser.START_TAG)
                             && WallpaperCategory.TAG_NAME.equals(parser.getName())) {
 
                         WallpaperCategory.Builder categoryBuilder =
                                 new WallpaperCategory.Builder(mPartnerProvider.getResources(),
                                         Xml.asAttributeSet(parser));
                         categoryBuilder.setPriorityIfEmpty(PRIORITY_SYSTEM + priorityTracker++);
                         final int categoryDepth = parser.getDepth();
-                        boolean publishedPlaceholder = false;
                         while (((type = parser.next()) != XmlPullParser.END_TAG
                                 || parser.getDepth() > categoryDepth)
                                 && type != XmlPullParser.END_DOCUMENT) {
                             if (type == XmlPullParser.START_TAG) {
                                 WallpaperInfo wallpaper = null;
                                 if (SystemStaticWallpaperInfo.TAG_NAME.equals(parser.getName())) {
                                     wallpaper = SystemStaticWallpaperInfo
                                             .fromAttributeSet(mPartnerProvider.getPackageName(),
                                                     categoryBuilder.getId(),
                                                     Xml.asAttributeSet(parser));
 
                                 } else if (LiveWallpaperInfo.TAG_NAME.equals(parser.getName())) {
                                     wallpaper = LiveWallpaperInfo.fromAttributeSet(mAppContext,
                                             categoryBuilder.getId(), Xml.asAttributeSet(parser));
                                 }
                                 if (wallpaper != null) {
                                     categoryBuilder.addWallpaper(wallpaper);
-                                    // Publish progress only if there's at least one wallpaper
-                                    if (!publishedPlaceholder) {
-                                        publishProgress(categoryBuilder.buildPlaceholder());
-                                        publishedPlaceholder = true;
-                                    }
                                 }
                             }
                         }
                         WallpaperCategory category = categoryBuilder.build();
                         if (!category.getUnmodifiableWallpapers().isEmpty()) {
                             categories.add(category);
                             publishProgress(category);
                         }
                     }
                 }

commit 174a5f7891596d6eae62627b81782fe9a959413c (HEAD, tag: SQ1A.220205.002.2022020800, m/master, grapheneos/12)
Author: flawedworld <flawedworld@flawed.world>
Date:   Fri 2022-01-14 10:47:58+0000

    Remove DeepLinkActivity from AndroidManifest.xml
---
 AndroidManifest.xml | 14 --------------
 1 file changed, 14 deletions(-)

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 72d721d7cb269deb158f5d8ca01b3f7509f22db7..bad42f666e9f00207a24f31847208b536e499542 100755
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -68,34 +68,20 @@
         android:label="@string/app_name"
         android:resizeableActivity="false"
         android:theme="@style/WallpaperTheme.NoBackground"
         android:exported="true">
         <intent-filter>
             <action android:name="android.intent.action.SET_WALLPAPER"/>
             <category android:name="android.intent.category.DEFAULT"/>
         </intent-filter>
     </activity>
 
-    <activity android:name="com.android.wallpaper.picker.DeepLinkActivity"
-        android:theme="@style/WallpaperTheme.NoBackground"
-        android:exported="true">
-        <intent-filter android:autoVerify="true">
-            <action android:name="android.intent.action.VIEW" />
-            <category android:name="android.intent.category.DEFAULT" />
-            <category android:name="android.intent.category.BROWSABLE" />
-            <data
-                android:host="g.co"
-                android:pathPrefix="/wallpaper"
-                android:scheme="https" />
-        </intent-filter>
-    </activity>
-
     <activity-alias
         android:name="com.android.wallpaper.picker.CategoryPickerActivity"
         android:targetActivity="com.android.wallpaper.picker.CustomizationPickerActivity"
         android:label="@string/app_name"
         android:exported="true">
       <intent-filter>
         <action android:name="android.intent.action.MAIN"/>
       </intent-filter>
     </activity-alias>
 

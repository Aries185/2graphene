commit 0b9bbac807e16d7a48cd0ba30d3d1e33e3fc0c04
Author: Luca Stefani <luca.stefani.ge1@gmail.com>
Date:   Fri 2019-11-01 21:14:29+0100

    Add wallpaper privapp whitelist
    
    Change-Id: I044b1d9201ac0b8780fc37a387f401f3dd0ddeac
---
 Android.bp                                        | 10 ++++++++++
 privapp_whitelist_com.android.wallpaper.xml (new) | 24 +++++++++++++++++++++++
 2 files changed, 34 insertions(+)

diff --git a/Android.bp b/Android.bp
index 57d30ce5a45e2005ff2912b1cbff4b001d70923d..c82aa4b15d5b65b98809f1513a3eee01399e0b71 100644
--- a/Android.bp
+++ b/Android.bp
@@ -90,12 +90,22 @@ android_app {
         enabled: false,
     },
     kotlincflags: ["-Xjvm-default=enable"],
     certificate: "",
 
     privileged: true,
     system_ext_specific: true,
     platform_apis: true,
     manifest: "AndroidManifest.xml",
     additional_manifests: [":WallpaperPicker2_Manifest"],
+
+    required: ["privapp_whitelist_com.android.wallpaper.xml"],
     overrides: ["WallpaperPicker2"],
 }
+
+prebuilt_etc_xml {
+    name: "privapp_whitelist_com.android.wallpaper.xml",
+    src: "privapp_whitelist_com.android.wallpaper.xml",
+    system_ext_specific: true,
+    filename_from_src: true,
+    sub_dir: "permissions",
+}
diff --git a/privapp_whitelist_com.android.wallpaper.xml b/privapp_whitelist_com.android.wallpaper.xml
new file mode 100644
index 0000000000000000000000000000000000000000..e3f3b658dfb1e90752dbac2b97b04e6eaa52126d
--- /dev/null
+++ b/privapp_whitelist_com.android.wallpaper.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2019 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License
+  -->
+<permissions>
+    <privapp-permissions package="com.android.wallpaper">
+        <permission name="android.permission.SET_WALLPAPER_COMPONENT"/>
+        <permission name="android.permission.MODIFY_DAY_NIGHT_MODE"/>
+        <permission name="android.permission.CHANGE_OVERLAY_PACKAGES"/>
+        <permission name="android.permission.WRITE_SECURE_SETTINGS" />
+    </privapp-permissions>
+</permissions>

commit 1b852a759b49c6c8876625be9cdedee0776e46b2
Author: Danny Lin <danny@kdrag0n.dev>
Date:   Tue 2021-10-05 19:00:36-0700

    Override legacy WallpaperPicker app
    
    Change-Id: I9a1907527eea0e8e7cd10bab64ba79c2c4006c59
---
 Android.bp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Android.bp b/Android.bp
index c82aa4b15d5b65b98809f1513a3eee01399e0b71..fcedfdfe85a1b8c57eb32c91920dc861478f3af8 100644
--- a/Android.bp
+++ b/Android.bp
@@ -92,20 +92,20 @@ android_app {
     kotlincflags: ["-Xjvm-default=enable"],
     certificate: "",
 
     privileged: true,
     system_ext_specific: true,
     platform_apis: true,
     manifest: "AndroidManifest.xml",
     additional_manifests: [":WallpaperPicker2_Manifest"],
 
     required: ["privapp_whitelist_com.android.wallpaper.xml"],
-    overrides: ["WallpaperPicker2"],
+    overrides: ["WallpaperPicker2", "WallpaperPicker"],
 }
 
 prebuilt_etc_xml {
     name: "privapp_whitelist_com.android.wallpaper.xml",
     src: "privapp_whitelist_com.android.wallpaper.xml",
     system_ext_specific: true,
     filename_from_src: true,
     sub_dir: "permissions",
 }

commit 4651a95448373c2ba6f9e4ea30c5bf83a3176d04
Author: LuK1337 <priv.luk@gmail.com>
Date:   Tue 2020-09-15 03:27:19+0200

    Add wallpaper default permissions
    
    Change-Id: If43a594da31fbab9280ce45b049737f6c534b620
---
 Android.bp                                         | 14 +++++++-
 ...ult_permissions_com.android.wallpaper.xml (new) | 37 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 1 deletion(-)

diff --git a/Android.bp b/Android.bp
index fcedfdfe85a1b8c57eb32c91920dc861478f3af8..0d57de2a0b49c6ade18fb06488010dbe3afc74a4 100644
--- a/Android.bp
+++ b/Android.bp
@@ -91,21 +91,33 @@ android_app {
     },
     kotlincflags: ["-Xjvm-default=enable"],
     certificate: "",
 
     privileged: true,
     system_ext_specific: true,
     platform_apis: true,
     manifest: "AndroidManifest.xml",
     additional_manifests: [":WallpaperPicker2_Manifest"],
 
-    required: ["privapp_whitelist_com.android.wallpaper.xml"],
+    required: [
+        "privapp_whitelist_com.android.wallpaper.xml",
+        "default_permissions_com.android.wallpaper.xml",
+    ],
+
     overrides: ["WallpaperPicker2", "WallpaperPicker"],
 }
 
 prebuilt_etc_xml {
     name: "privapp_whitelist_com.android.wallpaper.xml",
     src: "privapp_whitelist_com.android.wallpaper.xml",
     system_ext_specific: true,
     filename_from_src: true,
     sub_dir: "permissions",
 }
+
+prebuilt_etc_xml {
+    name: "default_permissions_com.android.wallpaper.xml",
+    src: "default_permissions_com.android.wallpaper.xml",
+    system_ext_specific: true,
+    filename_from_src: true,
+    sub_dir: "default-permissions",
+}
diff --git a/default_permissions_com.android.wallpaper.xml b/default_permissions_com.android.wallpaper.xml
new file mode 100644
index 0000000000000000000000000000000000000000..41b23ce171fce5bc63a38aed0c4570ce29047f9d
--- /dev/null
+++ b/default_permissions_com.android.wallpaper.xml
@@ -0,0 +1,37 @@
+<?xml version='1.0' encoding='utf-8' standalone='yes' ?>
+<!--
+     Copyright (C) 2019-2020 The LineageOS Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<!--
+    This file contains permissions to be granted by default. Default
+    permissions are granted to special platform components and to apps
+    that are approved to get default grants. The special components
+    are apps that are expected to work out-of-the-box as they provide
+    core use cases such as default dialer, default email, etc. These
+    grants are managed by the platform. The apps that are additionally
+    approved for default grants are ones that provide carrier specific
+    functionality, ones legally required at some location, ones providing
+    alternative disclosure and opt-out UI, ones providing highlight features
+    of a dedicated device, etc. This file contains only the latter exceptions.
+    Fixed permissions cannot be controlled by the user and need a special
+    approval. Typically these are to ensure either legally mandated functions
+    or the app is considered a part of the OS.
+-->
+<exceptions>
+    <exception package="com.android.wallpaper">
+        <permission name="android.permission.READ_EXTERNAL_STORAGE" fixed="false"/>
+    </exception>
+</exceptions>

commit 3c5cf62f489d5ca4eac2704afc0fa6981ed2df34
Author: Luca Stefani <luca.stefani.ge1@gmail.com>
Date:   Fri 2019-11-01 23:17:08+0100

    Specify we read and write launcher settings
    
    Change-Id: Ifc8196588443b007602118389ca76d34ab531f14
---
 AndroidManifest.xml | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 90e05cb1b08d9e9ec2e03c01a666780a7bdec44e..391f06b8d9b5630ba110027774e8fde012835037 100755
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -29,20 +29,23 @@
         <!-- Intent filter with action WallpaperService (live wallpaper interface) -->
         <intent>
             <action android:name="android.service.wallpaper.WallpaperService" />
         </intent>
         <!-- Intent filter with action used to discover partner -->
         <intent>
             <action android:name="com.android.launcher3.action.PARTNER_CUSTOMIZATION" />
         </intent>
     </queries>
 
+    <uses-permission android:name="com.android.launcher3.permission.READ_SETTINGS" />
+    <uses-permission android:name="com.android.launcher3.permission.WRITE_SETTINGS" />
+
     <application
         tools:replace="android:icon,android:name"
         android:extractNativeLibs="false"
         android:hardwareAccelerated="true"
         android:icon="@drawable/ic_home"
         android:label="@string/app_name"
         android:requiredForAllUsers="true"
         android:restoreAnyVersion="true"
         android:supportsRtl="true"
         android:name="com.android.customization.picker.CustomizationPickerApplication"

commit ca891a7cfd778a0b0ad7eecf499a6279e74fd388
Author: Danny Lin <danny@kdrag0n.dev>
Date:   Tue 2021-10-05 19:12:40-0700

    Declare HOME query for launcher discovery
    
    ThemePicker needs to query the current launcher in order to render
    launcher/wallpaper previews, toggle themed icons, and change the app
    grid size.
    
    Change-Id: Id79fe1eaa4d09f775a37a1dfb1091ed08a1d3422
---
 AndroidManifest.xml | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 391f06b8d9b5630ba110027774e8fde012835037..9529b60e428107c3b2cb06bb341e209750a6d7d1 100755
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -27,20 +27,25 @@
             <action android:name="android.intent.action.VIEW" />
         </intent>
         <!-- Intent filter with action WallpaperService (live wallpaper interface) -->
         <intent>
             <action android:name="android.service.wallpaper.WallpaperService" />
         </intent>
         <!-- Intent filter with action used to discover partner -->
         <intent>
             <action android:name="com.android.launcher3.action.PARTNER_CUSTOMIZATION" />
         </intent>
+        <!-- Intent filter with action used to discover launcher -->
+        <intent>
+            <action android:name="android.intent.action.MAIN" />
+            <category android:name="android.intent.category.HOME" />
+        </intent>
     </queries>
 
     <uses-permission android:name="com.android.launcher3.permission.READ_SETTINGS" />
     <uses-permission android:name="com.android.launcher3.permission.WRITE_SETTINGS" />
 
     <application
         tools:replace="android:icon,android:name"
         android:extractNativeLibs="false"
         android:hardwareAccelerated="true"
         android:icon="@drawable/ic_home"

commit f4ccba9422c69117442dbd858f7a9fcea5a6bb7e
Author: Danny Lin <danny@kdrag0n.dev>
Date:   Tue 2021-10-05 22:40:58-0700

    Add permission for launcher preview rendering
    
    Change-Id: Ie707dcd98161e8f5993b0504295fddc3f395cd20
---
 AndroidManifest.xml                         | 1 +
 privapp_whitelist_com.android.wallpaper.xml | 1 +
 2 files changed, 2 insertions(+)

diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 9529b60e428107c3b2cb06bb341e209750a6d7d1..d8cb91ecdbe62c0dfbc886f6747154823677d626 100755
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -1,20 +1,21 @@
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
           xmlns:tools="http://schemas.android.com/tools"
           package="com.android.wallpaper">
 
     <uses-sdk android:targetSdkVersion="30" android:minSdkVersion="28"/>
 
     <uses-permission android:name="android.permission.CHANGE_OVERLAY_PACKAGES"/>
     <uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/>
     <uses-permission android:name="android.permission.SET_WALLPAPER_COMPONENT" />
+    <uses-permission android:name="android.permission.BIND_WALLPAPER" />
 
     <uses-permission android:name="android.permission.MODIFY_DAY_NIGHT_MODE" />
 
     <queries>
         <!-- Specific intents Wallpaper picker query for -->
         <!-- Intent filter with action SET_WALLPAPER -->
         <intent>
             <action android:name="android.intent.action.SET_WALLPAPER" />
         </intent>
         <!-- Intent filter with action GET_CONTENT and data's mimeType as "image/*" -->
diff --git a/privapp_whitelist_com.android.wallpaper.xml b/privapp_whitelist_com.android.wallpaper.xml
index e3f3b658dfb1e90752dbac2b97b04e6eaa52126d..5dee99b0b9153e49fa55a1f1d81dab3cbf9d5118 100644
--- a/privapp_whitelist_com.android.wallpaper.xml
+++ b/privapp_whitelist_com.android.wallpaper.xml
@@ -10,15 +10,16 @@
   ~
   ~ Unless required by applicable law or agreed to in writing, software
   ~ distributed under the License is distributed on an "AS IS" BASIS,
   ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   ~ See the License for the specific language governing permissions and
   ~ limitations under the License
   -->
 <permissions>
     <privapp-permissions package="com.android.wallpaper">
         <permission name="android.permission.SET_WALLPAPER_COMPONENT"/>
+        <permission name="android.permission.BIND_WALLPAPER"/>
         <permission name="android.permission.MODIFY_DAY_NIGHT_MODE"/>
         <permission name="android.permission.CHANGE_OVERLAY_PACKAGES"/>
         <permission name="android.permission.WRITE_SECURE_SETTINGS" />
     </privapp-permissions>
 </permissions>

commit e21451b745c959db2bc40aa3610e66f4e1646aae
Author: flawedworld <38294951+flawedworld@users.noreply.github.com>
Date:   Sat 2021-04-17 15:28:59+0100

    Use GrapheneOS apps to preview icons
    
    Change-Id: I88947e1dc5b56bdcd57c44ab2f93de4c5e2cc266
---
 res/values/override.xml | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/res/values/override.xml b/res/values/override.xml
index a070dbec1a8ae45b6f5dacadd5e4bed37ac69d2b..42bc4cff144ddc31f75f2843bd39a7495492adb8 100644
--- a/res/values/override.xml
+++ b/res/values/override.xml
@@ -19,18 +19,18 @@
     <string name="themes_stub_package" translatable="false"/>
     <string name="clocks_stub_package" translatable="false"/>
     <!-- Authority of a provider in System UI that will provide preview info for available clockfaces. -->
     <string name="clocks_provider_authority" translatable="false">com.android.keyguard.clock</string>
 
     <string name="launcher_overlayable_package" translatable="false">com.android.launcher3</string>
 
     <!-- List of packages whose icons are used to preview the icon shape for a theme. These are
         typically GMS apps so they should be available in GMS devices. -->
     <array name="icon_shape_preview_packages">
-        <item>com.google.android.gm</item>
-        <item>com.google.android.googlequicksearchbox</item>
-        <item>com.google.android.apps.photos</item>
-        <item>com.google.android.apps.docs</item>
-        <item>com.google.android.youtube</item>
-        <item>com.android.vending</item>
+        <item>com.android.deskclock</item>
+        <item>com.android.messaging</item>
+        <item>com.android.settings</item>
+        <item>org.chromium.chrome</item>
+        <item>com.android.camera2</item>
+        <item>com.android.contacts</item>
     </array>
 </resources>

commit 445a8f9b194db27ceea0f63bd522197f93ba8b56 (HEAD, tag: SP1A.211105.002.2021110617, m/master, grapheneos/12)
Author: Daniel Micay <danielmicay@gmail.com>
Date:   Sat 2021-10-09 16:50:31-0400

    use generic default themes stub
---
 res/values/override.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/res/values/override.xml b/res/values/override.xml
index 42bc4cff144ddc31f75f2843bd39a7495492adb8..3c28337577cacf2818b0889c769280cec3a88108 100644
--- a/res/values/override.xml
+++ b/res/values/override.xml
@@ -9,21 +9,21 @@
 
           http://www.apache.org/licenses/LICENSE-2.0
 
      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
 <resources>
-    <string name="themes_stub_package" translatable="false"/>
+    <string name="themes_stub_package" translatable="false">com.android.customization.stub</string>
     <string name="clocks_stub_package" translatable="false"/>
     <!-- Authority of a provider in System UI that will provide preview info for available clockfaces. -->
     <string name="clocks_provider_authority" translatable="false">com.android.keyguard.clock</string>
 
     <string name="launcher_overlayable_package" translatable="false">com.android.launcher3</string>
 
     <!-- List of packages whose icons are used to preview the icon shape for a theme. These are
         typically GMS apps so they should be available in GMS devices. -->
     <array name="icon_shape_preview_packages">
         <item>com.android.deskclock</item>
